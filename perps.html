<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NX-Perps — Perpetuals Trading | nexxore</title>
  <meta name="description" content="Trade perpetuals with on-chain transparency. No CEX risk. Modular architecture.">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
  
  <style>
    :root {
      --font-body: 'Inter', -apple-system, sans-serif;
      --font-mono: 'JetBrains Mono', monospace;
      --bg-primary: #000000;
      --bg-secondary: #050505;
      --bg-card: rgba(255, 255, 255, 0.02);
      --text-primary: #ffffff;
      --text-secondary: rgba(255, 255, 255, 0.6);
      --text-muted: rgba(255, 255, 255, 0.4);
      --border-color: rgba(255, 255, 255, 0.08);
      --border-hover: rgba(255, 255, 255, 0.15);
      /* Trading Colors */
      --long-green: #22c55e;
      --long-green-bg: rgba(34, 197, 94, 0.1);
      --long-green-border: rgba(34, 197, 94, 0.3);
      --short-red: #ef4444;
      --short-red-bg: rgba(239, 68, 68, 0.1);
      --short-red-border: rgba(239, 68, 68, 0.3);
      --accent-blue: #3b82f6;
      --accent-purple: #a855f7;
      --warning-yellow: #f59e0b;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: var(--font-body);
      background: var(--bg-primary);
      color: var(--text-secondary);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 24px;
    }

    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 24px;
      border-bottom: 1px solid var(--border-color);
      background: var(--bg-primary);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .back-link {
      color: var(--text-muted);
      text-decoration: none;
      font-size: 0.75rem;
      transition: color 0.15s;
    }
    .back-link:hover { color: var(--text-primary); }

    .header-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .status-badge {
      padding: 5px 12px;
      border: 1px solid var(--border-color);
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
    }

    .connect-btn {
      padding: 8px 20px;
      background: var(--text-primary);
      color: var(--bg-primary);
      border: none;
      font-size: 0.75rem;
      font-weight: 600;
      cursor: pointer;
    }
    .connect-btn:hover { background: rgba(255,255,255,0.9); }

    /* Stats Bar */
    .stats-bar {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 1px;
      background: var(--border-color);
      border-bottom: 1px solid var(--border-color);
    }

    .stat-card {
      background: var(--bg-primary);
      padding: 16px 20px;
      text-align: center;
    }

    .stat-label {
      font-size: 0.6rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 6px;
    }

    .stat-value {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text-primary);
      font-family: var(--font-mono);
    }

    /* Market Selector */
    .market-selector {
      display: flex;
      gap: 0;
      padding: 0;
      border-bottom: 1px solid var(--border-color);
      overflow-x: auto;
    }

    .market-btn {
      padding: 14px 24px;
      background: transparent;
      border: none;
      border-bottom: 2px solid transparent;
      color: var(--text-muted);
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
      font-family: var(--font-body);
      white-space: nowrap;
    }
    .market-btn:hover { color: var(--text-secondary); }
    .market-btn.active {
      color: var(--text-primary);
      border-bottom-color: var(--text-primary);
    }

    /* Main Grid */
    .main-grid {
      display: grid;
      grid-template-columns: 1fr 360px;
      gap: 1px;
      background: var(--border-color);
      min-height: calc(100vh - 200px);
    }

    @media (max-width: 1024px) {
      .main-grid { grid-template-columns: 1fr; }
    }

    /* Chart Panel */
    .chart-panel {
      background: var(--bg-primary);
      padding: 20px;
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .chart-title {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .chart-symbol {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .live-price {
      font-size: 1.5rem;
      font-weight: 600;
      font-family: var(--font-mono);
      color: var(--text-primary);
    }

    .price-change {
      font-size: 0.75rem;
      padding: 4px 8px;
      font-family: var(--font-mono);
    }
    .price-change.positive {
      background: var(--long-green-bg);
      border: 1px solid var(--long-green-border);
      color: var(--long-green);
    }
    .price-change.negative {
      background: var(--short-red-bg);
      border: 1px solid var(--short-red-border);
      color: var(--short-red);
    }

    .timeframe-selector {
      display: flex;
      gap: 2px;
    }

    .timeframe-btn {
      padding: 6px 12px;
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-muted);
      font-size: 0.7rem;
      cursor: pointer;
      transition: all 0.15s;
      font-family: var(--font-body);
    }
    .timeframe-btn:hover { color: var(--text-secondary); border-color: var(--border-hover); }
    .timeframe-btn.active {
      background: rgba(255,255,255,0.05);
      color: var(--text-primary);
      border-color: var(--border-hover);
    }

    #tradingChart {
      width: 100%;
      height: 400px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
    }

    .chart-stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1px;
      background: var(--border-color);
      margin-top: 16px;
    }

    .chart-stat {
      background: var(--bg-primary);
      padding: 12px;
      text-align: center;
    }

    .chart-stat-label {
      font-size: 0.6rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }

    .chart-stat-value {
      font-size: 0.85rem;
      font-family: var(--font-mono);
      color: var(--text-primary);
    }

    /* Order Panel */
    .order-panel {
      background: var(--bg-primary);
      padding: 20px;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--border-color);
    }

    .panel-title {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-primary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .position-tabs {
      display: flex;
      gap: 0;
      margin-bottom: 20px;
      background: var(--border-color);
    }

    .position-tab {
      flex: 1;
      padding: 10px;
      background: var(--bg-primary);
      border: none;
      color: var(--text-muted);
      font-size: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
      font-family: var(--font-body);
    }
    .position-tab:hover { color: var(--text-secondary); }
    .position-tab.active {
      color: var(--text-primary);
      background: rgba(255,255,255,0.03);
    }
    .position-tab.active.long {
      color: var(--long-green);
      background: var(--long-green-bg);
    }
    .position-tab.active.short {
      color: var(--short-red);
      background: var(--short-red-bg);
    }

    .input-group {
      margin-bottom: 16px;
    }

    .input-label {
      display: block;
      font-size: 0.7rem;
      color: var(--text-muted);
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .input-field {
      width: 100%;
      padding: 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      font-size: 0.9rem;
      font-family: var(--font-mono);
    }
    .input-field:focus {
      outline: none;
      border-color: var(--border-hover);
    }
    .input-field::placeholder { color: var(--text-muted); }

    .leverage-display {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .leverage-value {
      font-size: 1rem;
      font-weight: 600;
      font-family: var(--font-mono);
      color: var(--text-primary);
    }

    .leverage-slider {
      width: 100%;
      height: 4px;
      background: var(--border-color);
      -webkit-appearance: none;
      appearance: none;
      cursor: pointer;
    }
    .leverage-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      background: var(--text-primary);
      cursor: pointer;
    }

    .order-summary {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      padding: 16px;
      margin: 20px 0;
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 0.8rem;
    }
    .summary-row:last-child { margin-bottom: 0; }

    .summary-label { color: var(--text-muted); }
    .summary-value {
      color: var(--text-primary);
      font-family: var(--font-mono);
    }

    .btn-long {
      width: 100%;
      padding: 14px;
      background: var(--long-green);
      color: #000000;
      border: none;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 8px;
      transition: all 0.15s;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .btn-long:hover { 
      background: #16a34a;
      box-shadow: 0 0 20px rgba(34, 197, 94, 0.3);
    }

    .btn-short {
      width: 100%;
      padding: 14px;
      background: var(--short-red);
      color: #000000;
      border: none;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .btn-short:hover { 
      background: #dc2626;
      box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
    }

    /* PnL Colors */
    .pnl-positive {
      color: var(--long-green) !important;
    }
    .pnl-negative {
      color: var(--short-red) !important;
    }
    
    /* Funding Rate Colors */
    .funding-positive {
      color: var(--long-green);
    }
    .funding-negative {
      color: var(--short-red);
    }

    /* Leverage Warning */
    .leverage-warning {
      font-size: 0.7rem;
      color: var(--warning-yellow);
      margin-top: 8px;
    }

    /* Order Type Pills */
    .order-type-pills {
      display: flex;
      gap: 2px;
      margin-bottom: 16px;
    }
    
    .order-type-pill {
      flex: 1;
      padding: 8px;
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-muted);
      font-size: 0.7rem;
      cursor: pointer;
      transition: all 0.15s;
      text-align: center;
    }
    .order-type-pill:hover {
      border-color: var(--border-hover);
      color: var(--text-secondary);
    }
    .order-type-pill.active {
      background: rgba(59, 130, 246, 0.1);
      border-color: var(--accent-blue);
      color: var(--accent-blue);
    }

    /* Positions Section */
    .positions-section {
      padding: 24px;
      border-top: 1px solid var(--border-color);
    }

    .section-title {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-primary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 16px;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
    }

    .data-table th {
      text-align: left;
      padding: 10px 12px;
      font-size: 0.6rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
      border-bottom: 1px solid var(--border-color);
    }

    .data-table td {
      padding: 14px 12px;
      font-size: 0.8rem;
      font-family: var(--font-mono);
      border-bottom: 1px solid var(--border-color);
      color: var(--text-primary);
    }

    .empty-state {
      text-align: center;
      padding: 48px 20px;
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    /* LP Vaults Section */
    .vaults-section {
      padding: 24px;
      border-top: 1px solid var(--border-color);
    }

    .vaults-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1px;
      background: var(--border-color);
    }

    .vault-card {
      background: var(--bg-primary);
      padding: 24px;
    }

    .vault-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .vault-name {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text-primary);
    }

    .vault-apy {
      font-size: 1.2rem;
      font-weight: 600;
      font-family: var(--font-mono);
      color: var(--text-primary);
    }

    .vault-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 16px;
    }

    .vault-stat-label {
      font-size: 0.6rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }

    .vault-stat-value {
      font-size: 0.85rem;
      font-family: var(--font-mono);
      color: var(--text-primary);
    }

    .vault-btn {
      width: 100%;
      padding: 10px;
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-secondary);
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.15s;
    }
    .vault-btn:hover {
      border-color: var(--border-hover);
      color: var(--text-primary);
    }

    /* Architecture Section */
    .architecture-section {
      padding: 48px 24px;
      border-top: 1px solid var(--border-color);
    }

    .arch-header {
      text-align: center;
      margin-bottom: 32px;
    }

    .arch-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .arch-desc {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .arch-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1px;
      background: var(--border-color);
      max-width: 1000px;
      margin: 0 auto;
    }

    .arch-card {
      background: var(--bg-primary);
      padding: 24px;
    }

    .arch-card-title {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .arch-card-desc {
      font-size: 0.8rem;
      color: var(--text-muted);
      line-height: 1.5;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .stats-bar { grid-template-columns: repeat(2, 1fr); }
      .chart-stats { grid-template-columns: repeat(2, 1fr); }
      #tradingChart { height: 300px; }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <a href="index.html" class="back-link">← Back</a>
      <div class="header-title">NX-Perps</div>
    </div>
    <div class="header-right">
      <span class="status-badge">Testnet</span>
      <button class="connect-btn" id="connectWallet">Connect Wallet</button>
    </div>
  </header>

  <!-- Stats Bar -->
  <div class="stats-bar">
    <div class="stat-card">
      <div class="stat-label">Open Interest</div>
      <div class="stat-value">$0.00</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">24h Volume</div>
      <div class="stat-value">$0.00</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">LP TVL</div>
      <div class="stat-value">$0.00</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Funding Rate</div>
      <div class="stat-value">0.0100%</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Max Leverage</div>
      <div class="stat-value">50x</div>
    </div>
  </div>

  <!-- Market Selector -->
  <div class="market-selector">
    <button class="market-btn active" data-market="ETH">ETH-USD</button>
    <button class="market-btn" data-market="BTC">BTC-USD</button>
    <button class="market-btn" data-market="SOL">SOL-USD</button>
    <button class="market-btn" data-market="ARB">ARB-USD</button>
    <button class="market-btn" data-market="LINK">LINK-USD</button>
  </div>

  <!-- Main Trading Interface -->
  <div class="main-grid">
    <!-- Chart Panel -->
    <div class="chart-panel">
      <div class="chart-header">
        <div class="chart-title">
          <span class="chart-symbol">ETH-USD</span>
          <span class="live-price" id="livePrice">$3,245.67</span>
          <span class="price-change">+2.34%</span>
        </div>
        <div class="timeframe-selector">
          <button class="timeframe-btn" data-tf="1m">1m</button>
          <button class="timeframe-btn" data-tf="5m">5m</button>
          <button class="timeframe-btn" data-tf="15m">15m</button>
          <button class="timeframe-btn active" data-tf="1h">1H</button>
          <button class="timeframe-btn" data-tf="4h">4H</button>
          <button class="timeframe-btn" data-tf="1d">1D</button>
        </div>
      </div>

      <div id="tradingChart"></div>

      <div class="chart-stats">
        <div class="chart-stat">
          <div class="chart-stat-label">24h High</div>
          <div class="chart-stat-value">$3,312.45</div>
        </div>
        <div class="chart-stat">
          <div class="chart-stat-label">24h Low</div>
          <div class="chart-stat-value">$3,156.23</div>
        </div>
        <div class="chart-stat">
          <div class="chart-stat-label">Index Price</div>
          <div class="chart-stat-value">$3,244.89</div>
        </div>
        <div class="chart-stat">
          <div class="chart-stat-label">Mark Price</div>
          <div class="chart-stat-value">$3,245.12</div>
        </div>
      </div>
    </div>

    <!-- Order Panel -->
    <div class="order-panel">
      <div class="panel-header">
        <span class="panel-title">Place Order</span>
      </div>

      <div class="position-tabs">
        <button class="position-tab active">Market</button>
        <button class="position-tab">Limit</button>
        <button class="position-tab">Stop</button>
      </div>

      <div class="input-group">
        <label class="input-label">Size (USDC)</label>
        <input type="text" class="input-field" placeholder="0.00" id="orderSize">
      </div>

      <div class="input-group">
        <div class="leverage-display">
          <span class="input-label">Leverage</span>
          <span class="leverage-value" id="leverageValue">10x</span>
        </div>
        <input type="range" class="leverage-slider" min="1" max="50" value="10" id="leverageSlider">
      </div>

      <div class="order-summary">
        <div class="summary-row">
          <span class="summary-label">Position Size</span>
          <span class="summary-value">0.00 ETH</span>
        </div>
        <div class="summary-row">
          <span class="summary-label">Entry Price</span>
          <span class="summary-value">$3,245.67</span>
        </div>
        <div class="summary-row">
          <span class="summary-label">Liquidation Price</span>
          <span class="summary-value">$0.00</span>
        </div>
        <div class="summary-row">
          <span class="summary-label">Fee</span>
          <span class="summary-value">0.05%</span>
        </div>
      </div>

      <button class="btn-long">Long ETH</button>
      <button class="btn-short">Short ETH</button>
    </div>
  </div>

  <!-- Positions Section -->
  <div class="positions-section">
    <h3 class="section-title">Open Positions</h3>
    <div class="empty-state">
      No open positions. Connect wallet to start trading.
    </div>
  </div>

  <!-- LP Vaults Section -->
  <div class="vaults-section" id="lp-vaults">
    <h3 class="section-title">LP Vaults</h3>
    <div class="vaults-grid">
      <div class="vault-card">
        <div class="vault-header">
          <span class="vault-name">ETH Vault</span>
          <span class="vault-apy">12.4% APY</span>
        </div>
        <div class="vault-stats">
          <div>
            <div class="vault-stat-label">TVL</div>
            <div class="vault-stat-value">$0.00</div>
          </div>
          <div>
            <div class="vault-stat-label">Utilization</div>
            <div class="vault-stat-value">0%</div>
          </div>
        </div>
        <button class="vault-btn">Deposit</button>
      </div>
      <div class="vault-card">
        <div class="vault-header">
          <span class="vault-name">USDC Vault</span>
          <span class="vault-apy">8.2% APY</span>
        </div>
        <div class="vault-stats">
          <div>
            <div class="vault-stat-label">TVL</div>
            <div class="vault-stat-value">$0.00</div>
          </div>
          <div>
            <div class="vault-stat-label">Utilization</div>
            <div class="vault-stat-value">0%</div>
          </div>
        </div>
        <button class="vault-btn">Deposit</button>
      </div>
      <div class="vault-card">
        <div class="vault-header">
          <span class="vault-name">BTC Vault</span>
          <span class="vault-apy">10.8% APY</span>
        </div>
        <div class="vault-stats">
          <div>
            <div class="vault-stat-label">TVL</div>
            <div class="vault-stat-value">$0.00</div>
          </div>
          <div>
            <div class="vault-stat-label">Utilization</div>
            <div class="vault-stat-value">0%</div>
          </div>
        </div>
        <button class="vault-btn">Deposit</button>
      </div>
    </div>
  </div>

  <!-- Architecture Section -->
  <div class="architecture-section">
    <div class="arch-header">
      <h2 class="arch-title">Protocol Architecture</h2>
      <p class="arch-desc">Modular on-chain perpetuals with transparent execution</p>
    </div>
    <div class="arch-grid">
      <div class="arch-card">
        <div class="arch-card-title">Price Oracle</div>
        <div class="arch-card-desc">Multi-source price feeds with manipulation resistance and latency optimization</div>
      </div>
      <div class="arch-card">
        <div class="arch-card-title">Matching Engine</div>
        <div class="arch-card-desc">On-chain order matching with MEV protection and fair execution</div>
      </div>
      <div class="arch-card">
        <div class="arch-card-title">Funding Mechanism</div>
        <div class="arch-card-desc">Self-balancing funding rates that converge mark to index price</div>
      </div>
      <div class="arch-card">
        <div class="arch-card-title">Liquidation Engine</div>
        <div class="arch-card-desc">Progressive liquidations with LP backstop for systemic protection</div>
      </div>
    </div>
  </div>

  <script>
    // Chart initialization
    const chartContainer = document.getElementById('tradingChart');
    if (chartContainer && typeof LightweightCharts !== 'undefined') {
      const chart = LightweightCharts.createChart(chartContainer, {
        layout: {
          background: { type: 'solid', color: '#050505' },
          textColor: 'rgba(255, 255, 255, 0.4)',
        },
        grid: {
          vertLines: { color: 'rgba(255, 255, 255, 0.04)' },
          horzLines: { color: 'rgba(255, 255, 255, 0.04)' },
        },
        crosshair: {
          mode: LightweightCharts.CrosshairMode.Normal,
        },
        rightPriceScale: {
          borderColor: 'rgba(255, 255, 255, 0.08)',
        },
        timeScale: {
          borderColor: 'rgba(255, 255, 255, 0.08)',
        },
      });

      const candleSeries = chart.addCandlestickSeries({
        upColor: 'rgba(255, 255, 255, 0.9)',
        downColor: 'rgba(255, 255, 255, 0.3)',
        borderUpColor: 'rgba(255, 255, 255, 0.9)',
        borderDownColor: 'rgba(255, 255, 255, 0.3)',
        wickUpColor: 'rgba(255, 255, 255, 0.6)',
        wickDownColor: 'rgba(255, 255, 255, 0.2)',
      });

      // Sample data
      const data = [];
      let time = new Date('2024-01-01').getTime() / 1000;
      let price = 3200;
      for (let i = 0; i < 100; i++) {
        const open = price;
        const change = (Math.random() - 0.5) * 50;
        const close = price + change;
        const high = Math.max(open, close) + Math.random() * 20;
        const low = Math.min(open, close) - Math.random() * 20;
        data.push({ time, open, high, low, close });
        time += 3600;
        price = close;
      }
      candleSeries.setData(data);
      chart.timeScale().fitContent();
    }

    // Leverage slider
    const leverageSlider = document.getElementById('leverageSlider');
    const leverageValue = document.getElementById('leverageValue');
    if (leverageSlider) {
      leverageSlider.addEventListener('input', function() {
        leverageValue.textContent = this.value + 'x';
      });
    }

    // Market selector
    document.querySelectorAll('.market-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.market-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
      });
    });

    // Timeframe selector
    document.querySelectorAll('.timeframe-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.timeframe-btn').forEach(b => b.classList.remove('active'));
        this.classList.add('active');
      });
    });

    // Position tabs
    document.querySelectorAll('.position-tab').forEach(tab => {
      tab.addEventListener('click', function() {
        document.querySelectorAll('.position-tab').forEach(t => t.classList.remove('active'));
        this.classList.add('active');
      });
    });
  </script>
</body>
</html>
